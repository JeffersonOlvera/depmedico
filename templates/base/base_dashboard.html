<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Dashboard{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap/bootstrap.min.css') }}" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <link rel="icon" type="image/x-icon" href="/static/img/logo-min.png">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/medico/dashboard.css') }}">

</head>

<body class="background-body">
  <div class="d-flex">
    <!-- Sidebar -->

{% include 'base/sidebar_dashboard.html' %}

    <!-- Main Content -->
    <main class="main-content">
      <div>
        <header class="d-flex flex-wrap justify-content-between align-items-center mb-4 custom-bg p-3">
          <h1 class="h3 col-12 col-md-auto mb-2 mb-md-0">{% block dash_title %}{% endblock %}</h1>
          <div class="d-flex align-items-center col-12 col-md-auto">
            <!-- Buscar -->
            <div class="search-bar me-2">
              <i class="fas fa-search"></i>
              <input type="search" id="busqueda" class="form-control" placeholder="Buscar"
                style="min-width: 6vw; max-width: 12vw;" />
            </div>
            <!-- Filtro de Estado -->
            <div class="d-flex align-items-center gap-2 px-5">
              <label for="filtroEstado" class="form-label m-0 px-2">Filtro:</label>
              <select id="filtroEstado" class="form-select" style="max-width: 144px;">
                <option value="">Todos</option>
                <option value="Pendiente">Pendientes</option>
                <option value="Completada">Completadas</option>
              </select>
            </div>


            <!-- NOMBRE COLABORADOR-->
      <div class="d-flex align-items-center">
        <span class="badge rounded-pill bg-light text-danger border  me-2 d-none d-md-inline-block px-3 py-2 fw-semibold">
        {{ session['rol'] | upper }}
        </span>
        <!-- Dropdown del usuario -->
        {% if session['nombreColaborador'] %}
        <div class="dropdown">
          <!--Badge para mostrar el rol-->


          <button class="btn btn-link text-white dropdown-toggle text-decoration-none d-flex align-items-center" 
                  type="button" 
                  id="userDropdown" 
                  data-bs-toggle="dropdown" 
                  aria-expanded="false">
            <i class="fas fa-user-circle me-2 text-black" ></i>
            <span class="text-black">{{ session['nombreColaborador'] }}</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end dropdown__menu" aria-labelledby="userDropdown"style="z-index: 1080;">
            <!-- Opción de generar tokens solo para admin y GTH -->
            {% if session['rol'] == 'admin' or session['rol'] == 'GTH' %}
            <li>
              <a class="dropdown-item" href="{{ url_for('auth.view_tokens') }}">
                <i class="fas fa-key me-2"></i>Generar Tokens
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            {% endif %}

            {% if session['rol'] == 'doctora2' or session['rol'] == 'doctora' or session['rol'] == 'admin' %}
            <li>
              <a class="dropdown-item" href="{{ url_for('auth.home_gth') }}">
                <i class="fas fa-home me-2"></i>Vista colaborador
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            {% endif %}
            <li>
              <a class="dropdown-item" href="{{ url_for('auth.logout') }}">
                <i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión
              </a>
            </li>
          </ul>
        </div>
        {% endif %}
      </div>
          </div>
        </header>

        <!-- Cards -->
        <div class="row mb-4">
          <div class="col-md-4">
            <div class="card text-center h-100 custom-bg border-0 custom-bg shadow-sm">
              <div class="card-body d-flex justify-content-center">
                <i class="fa-solid fa-inbox"
                  style="font-size: 54px; color:#0d6efd; margin:0 24px; padding-top:8px "></i>
                <span class="justify-content-center w-75">
                  <h2 class="card-title" id="total-registros">0</h2>
                  <p class="card-text">Total recibidas</p>
                </span>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card text-center h-100 custom-bg border-0 custom-bg shadow-sm">
              <div class="card-body d-flex justify-content-center">
                <i class="fa-solid fa-clock"
                  style="font-size: 54px; color:#fce494; margin:0 24px; padding-top:8px "></i>
                <span class="justify-content-center w-75">
                  <h2 class="card-title" id="total-pendientes">0</h2>
                  <p class="card-text">Total pendientes</p>
                </span>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card text-center h-100 custom-bg border-0 custom-bg shadow-sm">
              <div class="card-body d-flex justify-content-center">
                <i class="fa-solid fa-circle-check"
                  style="font-size: 54px; color:#20c997; margin:0 24px; padding-top:8px "></i>
                <span class="justify-content-center w-75">
                  <h2 class="card-title" id="total-completados">0</h2>
                  <p class="card-text">Total completadas</p>
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Table -->
        <div class="row">
          <div class="col-12">
            <div class="card border-0 shadow-sm">
              <div class="card-body ">
                <div class="table-responsive"> <!-- Contenedor para el desbordamiento -->
                  <table class="table ">
                    <thead>
                      <tr>
                        <th style=" min-width: 300px">Nombre</th>
                        <th>Cédula</th>
                        <th class="text-center">Estado</th>
                        <th class="text-center">Fecha Creación</th>
                        <th class="text-center">Fecha Actualización</th>
                        <th style="width: 230px">Acciones</th>
                      </tr>
                    </thead>
                    <tbody id="tabla-datos"></tbody>
                  </table>
                </div>

                <!-- Controles de Paginación -->
                <nav aria-label="Page navigation">
                  <ul class="pagination justify-content-center" id="pagination"></ul>
                </nav>
              </div>
            </div>
          </div>
        </div>

        {% block actions %}
        <!-- Formularios ocultos para enviar la cédula para cada acción -->
        {% endblock %}
      </div>
    </main>
  </div>
  {% block script_api %}

  {% endblock %}

  <script src="{{ url_for('static', filename='js/bootstrap/bootstrap.bundle.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/popper.min.js') }}"></script>
</body>

</html>